--- a/dpsoftrast.c	2016-09-10 21:36:13.000000000 +0200
+++ b/dpsoftrast.c	2024-03-02 02:04:39.576523847 +0100
@@ -163,21 +163,21 @@
 #define DPSOFTRAST_DRAW_MAXCOMMANDPOOL 2097152
 #define DPSOFTRAST_DRAW_MAXCOMMANDSIZE 16384
 
-typedef ALIGN(struct DPSOFTRAST_State_Command_Pool_s
+typedef ALIGN(struct) DPSOFTRAST_State_Command_Pool_s
 {
 	int freecommand;
 	int usedcommands;
 	ALIGN(unsigned char commands[DPSOFTRAST_DRAW_MAXCOMMANDPOOL]);
 }
-DPSOFTRAST_State_Command_Pool);
+DPSOFTRAST_State_Command_Pool;
 
-typedef ALIGN(struct DPSOFTRAST_State_Triangle_s
+typedef ALIGN(struct) DPSOFTRAST_State_Triangle_s
 {
 	unsigned char mip[DPSOFTRAST_MAXTEXTUREUNITS]; // texcoord to screen space density values (for picking mipmap of textures)
 	float w[3];
 	ALIGN(float attribs[DPSOFTRAST_ARRAY_TOTAL][3][4]);
 }
-DPSOFTRAST_State_Triangle);
+DPSOFTRAST_State_Triangle;
 
 #define DPSOFTRAST_CALCATTRIB(triangle, span, data, slope, arrayindex) { \
 	slope = _mm_load_ps((triangle)->attribs[arrayindex][0]); \
@@ -198,7 +198,7 @@
 					
 #define DPSOFTRAST_DRAW_MAXSUBSPAN 16
 
-typedef ALIGN(struct DPSOFTRAST_State_Span_s
+typedef ALIGN(struct) DPSOFTRAST_State_Span_s
 {
 	int triangle; // triangle this span was generated by
 	int x; // framebuffer x coord
@@ -209,7 +209,7 @@
 	int depthbase; // depthbuffer value at x (add depthslope*startx to get first pixel's depthbuffer value)
 	int depthslope; // depthbuffer value pixel delta
 }
-DPSOFTRAST_State_Span);
+DPSOFTRAST_State_Span;
 
 #define DPSOFTRAST_DRAW_MAXSPANS 1024
 #define DPSOFTRAST_DRAW_MAXTRIANGLES 128
@@ -236,7 +236,7 @@
 }
 DPSOFTRAST_BLENDMODE;
 
-typedef ALIGN(struct DPSOFTRAST_State_Thread_s
+typedef ALIGN(struct) DPSOFTRAST_State_Thread_s
 {
 	void *thread;
 	int index;
@@ -300,9 +300,9 @@
 	DPSOFTRAST_State_Triangle triangles[DPSOFTRAST_DRAW_MAXTRIANGLES];
 	unsigned char pixelmaskarray[DPSOFTRAST_DRAW_MAXSPANLENGTH+4]; // LordHavoc: padded to allow some termination bytes
 }
-DPSOFTRAST_State_Thread);
+DPSOFTRAST_State_Thread;
 
-typedef ALIGN(struct DPSOFTRAST_State_s
+typedef ALIGN(struct) DPSOFTRAST_State_s
 {
 	int fb_width;
 	int fb_height;
@@ -358,7 +358,7 @@
 
 	DPSOFTRAST_State_Command_Pool commandpool;
 }
-DPSOFTRAST_State);
+DPSOFTRAST_State;
 
 DPSOFTRAST_State dpsoftrast;
 
